(function(a){'use strict';jQuery(document).ready(function(){a('.products').cvca_WooSmartLayout(),jQuery('.cvca-products-wrap').bind('DOMNodeInserted DOMNodeRemoved',function(){a('.products').cvca_WooSmartLayout()}),a(window).resize(function(){setTimeout(function(){a('.products').cvca_WooSmartLayout()},400),a('.products:not(.products-carousel)')[0]&&setTimeout(function(){a('.products:not(.products-carousel)').isotope({layoutMode:'fitRows'})},800)})}),a(window).load(function(){a('.products:not(.products-carousel)')[0]&&setTimeout(function(){a('.products').cvca_WooSmartLayout(),a('.products:not(.products-carousel)').isotope({layoutMode:'fitRows'})},100)}),jQuery.fn.extend({cvca_WooSmartLayout:function(){jQuery(this)[0]&&(a(this).hasClass('carousel')?a(this).find('.lazy-img').each(function(){a(this).attr('src',a(this).data('original'))}):jQuery(this).each(function(){var b,c=jQuery(this),d=c.outerWidth(),e='';c.find('.lazy-img')[0]&&(e=c.find('.lazy-img').parent().data('resolution'));var f=jQuery(this).data('width');if(c.hasClass('grid')){if(f){b=481<jQuery(window).width()?Math.floor(d/f):1;var g=d/b;c.find('.product').outerWidth(g-0.5)}if(''!=e){var h=c.find('.product').width();c.find('.lazy-img').parent().outerWidth(h).height(h/e)}}if(c.hasClass('list')&&(c.find('.product').outerWidth(d),''!=e)){var h=0.25*c.find('.product').width();c.find('.lazy-img').parent().outerWidth(h).height(h/e)}f&&c.isotope({layoutMode:'fitRows',masonry:{columns:b}}),c.find('.lazy-img').cvca_lazyImg()}))},cvca_lazyImg:function(){a(this)[0]&&(a(this).not('.loaded').parent().addClass('loading'),a(this).not('.loaded').lazyload({effect:'fadeIn',threshold:a(window).height(),load:function(){a(this).parent().removeClass('loading'),a(this).addClass('loaded')}}))}})})(jQuery);