!function(a){"use strict";jQuery(document).ready(function(){var t=a(".cvca-products-wrap");a(document).on("click",".cvca-products-wrap .cvca_search_button",function(){var e=a(this).prev().val(),d=a(this);a.ajax({url:t.data("url"),data:{action:"cvca_ajax_product_filter",cvca_search:e},type:"POST"}).success(function(a){d.parent().next().html(a)})}),t.find(".cvca-list-product-category a").on("click",function(e){e.preventDefault(),t.find(".cat-selected").html(a(this).text()+'<i class="cs-font clever-icon-down"></i>')}),t.find(".cvca-ajax-load a, .cvca-remove-attribute").on("click",function(e){e.preventDefault();var d=a(this);t=d.parents(".cvca-products-wrap"),t.addClass("loading");var o=(d.attr("href"),d.attr("title"),t.data("args"));if(o.action="cvca_ajax_product_filter",d.hasClass("cvca-product-attribute")?"object"!=typeof o.product_attribute||d.hasClass("active")?(o.product_attribute=[],o.attribute_value=[]):(o.product_attribute.push(d.data("value")),o.attribute_value.push(d.data("attribute_value"))):o[d.data("type")]=d.data("value"),o.paged=1,"product_cat"==d.data("type")&&(o.product_attribute=[],o.attribute_value=[],o.product_tag="",o.filter_categories=d.data("value"),o.show=""),"cvca-reset-filter"==d.data("type")&&(o.product_attribute=[],o.attribute_value=[],o.product_tag="",o.filter_categories=t.data("categories"),o.show="",o.price_filter=0,a(".wrap-content-product-filter ").find(".active").removeClass("active")),"cvca-remove-attr"==d.data("type")){var c=(d.next().data("value"),d.next().data("attribute_value")),i=o.attribute_value.indexOf(c);i>-1&&(o.attribute_value.splice(i,1),o.product_attribute.splice(i,1))}"cvca-remove-price"==d.data("type")&&(o.price_filter=0);var r=a('input[name="s"]').val();""!=r&&(o.s=r),d.hasClass("active")&&"cvca-reset-filter"!=d.data("type")?("product_cat"==d.data("type")?(o.filter_categories=t.data("categories"),d.parents(".cvca-list-product-category").find("li:first-child a").addClass("active")):o[d.data("type")]="",d.removeClass("active")):(d.parents(".cvca-ajax-load ").find(".active").removeClass("active"),d.addClass("active")),t.data("original",o),t.data("args",o),a.ajax({url:t.data("url"),data:o,type:"POST"}).success(function(e){a(document.body).trigger("cvca_woo_after_filter",{response:e,wrap:t,max_page:a(e).find(".cvca_ajax_load_more_button").data("maxpage"),current_page:o.paged})}).error(function(a){console.log(a)})}),a(document).on("click",".cvca-products-wrap .cvca_ajax_load_more_button",function(t){if(t.preventDefault(),!a(this).hasClass("disable")){var e=a(this).parents(".cvca-products-wrap"),d=e,o=e.data("args");a(this).addClass("cvca-loading");var c=a(this).data("maxpage");o.paged<c&&(o.action="cvca_ajax_product_filter",o.paged=parseInt(o.paged)+parseInt(1),a.ajax({url:a(this).attr("href"),data:o,type:"POST"}).success(function(t){a(document.body).trigger("cvca_woo_append_product",{response:a(t).find(".products").html(),wrap:d,max_page:c,current_page:o.paged})}).error(function(a){console.log(a)}))}}),a(".wrap-head-product-filter .cvca-toogle-filter").on("click",function(){a(this).toggleClass("active"),a(".cvca-wrap-adv-filter").slideToggle()}),a(".cvca-title-filter-item").on("click",function(t){t.preventDefault(),a(window).width()<769&&a(this).next().slideToggle()})}),a(document.body).bind("cvca_woo_append_product",function(t,e){var d=e.wrap,o=e.max_page,c=d.find(".product").outerWidth(),i=d.find(".product").width(),r=a(e.response).outerWidth(c),n="";if(r.each(function(){var t=a(this);t.find(".lazy-img")[0]&&""!=(n=t.find(".lazy-img").parent().data("resolution"))&&t.find(".lazy-img").parent().outerWidth(i).height(i/n)}),d.find(".products").append(r).isotope("appended",r),setTimeout(function(){d.find(".products").isotope({layoutMode:"fitRows"})},300),d.find(".lazy-img:not(.loaded)")[0]){d.find(".lazy-img:not(.loaded)").lazyload({effect:"fadeIn",threshold:a(window).height(),load:function(){a(this).parent().removeClass("loading"),a(this).addClass("loaded")}});var s="";d.find(".lazy-img:not(.loaded)").each(function(){(s=a(this).data("srcset"))&&a(this).attr("srcset",s)})}o==e.current_page?d.find(".cvca_ajax_load_more_button").addClass("disable").html(d.find(".cvca_ajax_load_more_button").data("empty")):d.find(".cvca_ajax_load_more_button").show(),d.find(".cvca_ajax_load_more_button").removeClass("cvca-loading")}),a(document.body).bind("cvca_woo_after_filter",function(t,e){var d=e.wrap,o=e.max_page,c=d.find(".product").outerWidth(),i=d.find(".product").width(),r=a(e.response).find(".product"),n="";if(r.outerWidth(c),r.each(function(){var t=a(this);t.find(".lazy-img")[0]&&""!=(n=t.find(".lazy-img").parent().data("resolution"))&&t.find(".lazy-img").parent().outerWidth(i).height(i/n)}),r[0]){if(d.find(".products").isotope("remove",d.find(".product")).append(r).isotope("appended",r).isotope("layout"),d.find(".lazy-img:not(.loaded)")[0]){d.find(".lazy-img:not(.loaded)").lazyload({effect:"fadeIn",threshold:a(window).height(),load:function(){a(this).parent().removeClass("loading"),a(this).addClass("loaded")}});var s="";d.find(".lazy-img:not(.loaded)").each(function(){(s=a(this).data("srcset"))&&a(this).attr("srcset",s)})}}else d.find(".products").html('<h3 class="products-emt">'+d.data("empty")+"</h3>");d.find(".cvca_ajax_load_more_button")[0]&&(o!=e.current_page&&o?d.find(".cvca_ajax_load_more_button").data("maxpage",o):d.find(".cvca_ajax_load_more_button").addClass("disable").html(d.find(".cvca_ajax_load_more_button").data("empty"))),d.removeClass("loading")})}(jQuery);